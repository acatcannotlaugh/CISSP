*   安全评估与测试

    *   6.1、设计和验证评估、测试和审计策略MTO

        *   内部

            *   内部审计是由组织内部审计人员执行，通常适用于组织内部。内部审计人员在执行审计时，通常完全独立于所评估的职能。

        *   外部

            *   外部审计通常由外部审计公司执行。因为执行评估的审计员与组织并没有利益冲突，所以外部审计具有很高的公信力。

        *   第三方

            *   第三方审计是由另一个组织，或以另一个组织的名义进行的审计。比如，监管机构可依据合同或法律对被监管公司进行审计。

            *   美国注册会计师协议标准SSAE16

                *   提供一个通用标准，审计员采用该标准来对服务组织进行评估，目的是让组织只斋要进行一次第三方评估，而不需要开展多次第三方评估，然后与用户及潜在用户共享最终评估报告。

                *   两种类型的报告

                    *   I类报告描述了被审计组织提供的控制措施，以及审计员基于该描述所形成的意见。 I告适用千某个时间点，不会涉及审计员对控制措施的实际测试。

                    *   II类报告至少覆盖 个月的时间，还包括审计员根据实际测试结果对这些控制措施的有效性所形成的意见。

                    *   通常认为 II 类报告比 I类型报告更可靠，因为 II 类报告包括对控制措施的独立测试。I类报告只是让服务组织自圆其说，控制措施已按照描述实现。

            *   COBIT(Control Objectives for Information and related Technology，信息及相关技术的控制目标)

                *   是一个开展审计和评估的通用框架

                *   描述组织围绕信息系统所具备的通用要求

            *   ISO27000：是国际标准化组织（ISO）发布的一个系列标准，用于信息安全管理系统（ISMS）。它提供了一套信息安全管理的最佳实践框架，帮助组织有效地管理其信息资产的安全性。

                *   ISO27001描述建立信息安全系统的标准方法

                *   ISO27002详细介绍信息安全控制的细节

    *   6.2、进行安全评估测试

        *   漏洞评估

            *   漏洞评估是信息安全专业人员手中最重要的测试工具之一 ，漏洞扫描和渗透测试为安全专业员提供一种有关系统及应用安全控制措施脆弱性的视角。

            *   漏洞描述

                *   安全内容自动化协议SCAP-Security Content Antomation Protocol：为漏洞描述和评估提供一种通用语言的通用标准

                *   通用漏洞披露CVE-Common Vulnerabilities and Exposures：提供一个描述安全漏洞的命名系统

                *   通用漏洞评分系统CVSS-Common Vulnerability Scoring System：提供一个描述安全漏洞严重性的标准化评分系统

                *   通用配置枚举CCE-Common Configuration Enumeration：提供一个系统配置问题的命名系统

                *   通用平台枚举CPE-Common Platform Enumeration：提供一个操作系统、应用程序及设备的命名系统

                *   可扩展配置检查表描述格式XCCDF-Extensible Configuration Checklist Description Format：提供一种描述安全检查表的语言

                *   开放漏洞评估语言OVAL-Open Vulnerability and Assessment Language：提供一种描述安全测试过程的语言

            *   漏洞扫描

                *   漏洞扫描可自动探测系统、应用程序及网络，探测可能被攻击者利用的漏洞。提供能力

                    *   识别网络中处于活动状态的主机

                    *   识别主机上处于活动状态和易受攻击的服务或端口

                    *   识别应用程序和系统提示信息捕获

                    *   识别操作系统

                    *   识别已经发现的操作系统和应用程序的漏洞

                    *   识别配置错误的设置

                    *   测试主机应用程序“使用策略和安全策略”的合规性

                    *   建立渗透测试的基础

                *   类型

                    *   网络发现扫描

                        *   网络发现扫描运用多种技术来扫描一段 IP 地址，探测存在开放网络端口的系统

                        *   TCP SYN 扫描：向目标系统的每个端口发送一个设置SYN标志位的数据包。这个数据包表示请求创建一个新TCP连接。如果扫描器接收到设置SYN ACK标志位的响应数据包，这种情况表明目标系统已经进入TCP三次握手的第二阶段，也说明这个端口是开放的。TCP SYN扫描也称为“半开放”(half-open)扫描。

                        *   TCP ACK扫描：发送设置ACK标志位的数据包，表明它属于某个开放连接。这种扫描可以尝试确定防火墙规则或防火墙方法。

                        *   TCP Connect扫描：远程系统的某个端口创建全连接。这种扫描类型适用于执行扫描的用户没有运行半开放扫描所需权限的情况。大多数其他类型的扫描需要发送原生数据包的能力，扫描用户可能受到操作系统限制，无法发送构造的原生数据包。

                        *   Xmas扫描：发送设置FIN PSH URG标志位的数据包。因为设置如此多标志位的数据包据说像“圣诞树一样亮起来”，故此得名。

                        *   软件nmap，端口状态

                            *   开放open：该端口在远程系统上已经开放，同时在该端口上运行应用程序，主要接受连接请求。

                            *   关闭close：该端口在远程系统可以访问，意味着防火墙允许访问该端口，但是在该端口上没有运行接受连接请求的应用程序。

                            *   过滤filter：因为防火墙会干扰连接尝试， nmap无法确定该端口是开放还是关闭。

                    *   网络漏洞扫描

                        *   当对某个系统进行网络漏洞扫描时，扫描器使用数据库中的测试用例来确定系统是否存在漏洞。

                        *   有些情况下，扫描器没有获取充足信息来判定某个漏洞是否存在，即使系统实际上不存在该漏洞，扫描器也会报告存在。这种悄况被称为误报(false positive report)

                        *   当漏洞扫描器漏过某个漏洞，未能向系统管理员报告存在危险情况，这种清况更危险，被称为漏报(false negative report)

                        *   扫描器软件：

                            *   Nessus商业软件

                            *   QualysGuard商业软件

                            *   NexXpose商业软件

                            *   OpenVAS开源

                            *   Aircrack无线网络安全评估

                    *   web应用漏洞扫描

                        *   漏洞类型

                            *   XSS

                            *   SQL注入

                            *   XSRF

                        *   软件

                            *   ACunetix商业

                            *   Nikto开源

                            *   Wapiti开源

                            *   Burp Suite

                    *   数据库漏洞扫描，sqlmap

                *   工作流程

                    *   检测：通常在扫描漏洞之后，第一次发现某个漏洞

                    *   验证：一旦扫描器检测到一个漏洞，管理员应该确认此漏洞，判断它是否为误报

                    *   修复：漏洞修复可能包括应用供应商提供的补丁，修改设备配置，执行规避漏洞的折中方法，安装web应用防火墙及采取组织漏洞的其他控制措施

        *   渗透测试

            *   执行渗透测试的安全专业人员尝试突破安全控制措施，入侵目标系统或应用来验证漏洞。

            *   软件，Metasploit

            *   阶段

                *   规划阶段，包括确定测试范围和规则的协议

                    *   规划阶段确保测试团队和管理人员对测试性质达成共识

                    *   明确测试是经过授权的

                *   信息收集和发现阶段，结合人工和自动化攻击来收集目标环境的信息

                    *   执行基本的侦察来确定系统功能

                    *   执行网络扫描发现扫描来识别系统开放的端口

                *   漏洞扫描阶段：探测系统脆弱点，结合网络漏洞扫描、web漏洞扫描和数据库漏洞扫描

                *   漏洞利用阶段：视图使用人工和自动化漏洞利用工具来尝试破坏系统安全防线

                *   报告阶段：总结渗透测试结果，并提出改进系统安全的建议

            *   类型

                *   白盒渗透测试：向攻击者提供目标系统的详细信息，这种情况通常可以绕过攻击之前的许多侦查步骤，缩短攻击时间，提升发现安全漏洞的可能性

                *   灰盒渗透测试：也称部分知识测试，有时是为了平衡白盒渗透测试和黑盒渗透测试的优缺点，当需要黑盒测试结果，但由于成本或时间受限，需要一些知识来完成测试时，常使用这种测试方式

                *   黑盒渗透测试：攻击之前不会向测试人员透露任何信息。这种测试模拟外部攻击者，在攻击之前试图获取有关业务和技术环境的信息。

                *   双盲测试-：也称隐蔽评估，是在不通知网络安全人员情况下进行的盲测

            *   步骤：发现、枚举、漏洞映射、利用

            *   入侵模拟攻击（Breach and Attack Simulations）：入侵和攻击模拟(BAS)平台寻求在渗透测试的某些方面实现自动化。这些系统旨在向系统和网络注入威胁指示器，以触发其他安全控制。例如，BAS平台可能往服务器上放置可疑文件，在网络上发送标记报文（beaconing packets），或探测系统中的已知漏洞。BAS平台实际上并没有发动攻击，但它正在对这些安全控制进行自动化测试，以识别可能需要进行控制更新或增强的缺陷

        *   软件测试

            *   代码审查与测试

                *   在代码移植到生产环境前，这些过程对研发工作进行第三方审查。在应用程序正式上线前，代码审查和测试可发现应用程序在安全、性能、可靠性方面的缺陷，从而避免对业务运营产生负面影响。

                *   代码审查Code Review

                    *   代码审查也称为“同行评审”(peer review)，即除了编写代码的开发人员，其他开发人员审查代码是否存在缺陷。

                    *   代码审查可能决定应用程序是允许移植到生产环境，还是退回给原开发人员，让其重写代码。

                    *   最正式的代码审查过程，范根检查法Fagan inspection

                        *   遵循严格的审查和测试过程

                        *   步骤：1.规划、2.概述、3.准备、4.审查、5.返工、6.追查

                    *   同行审查，宽松的代码审查流程

                        *   开发人员在会议上与一个或多个其他团队成员走查walk through代码

                        *   高级开发人员执行手动代码审查，在移植到生成环境之前签署所有代码

                        *   在移植到生产环境之前，使用自动化代码审查工具，检测常见应用缺陷

            *   静态测试

                *   静态测试在不运行软件的清况下，通过分析软件源代码或编译后的应用程序，评估软件的安全性。

                *   静态分析经常涉及自动化检测工具，用于检测常见的软件缺陷，如缓冲区溢出

            *   动态测试

                *   动态测试在软件运行环境下检测软件的安全性，如果组织部署他人开发的软件，这将是唯一选择。缺点：无法接触到软件的底层源代码

                *   使用方法，模拟事务，Synthetic Transactions

                    *   使用脚本化的事务用例

                    *   测试人员针对测试代码运行模拟事务，然后将事务活动的输出与预期结果进行比较

            *   模糊测试

                *   模糊测试是一种特殊的动态测试技术，向软件提供许多不同类型输入来测试其限制，发现之前未检测到的缺陷。模糊测试向软件提供无效的输入（随机产生的或特殊构造的输入），触发已知的软件漏洞。模糊测试人员监测软件的性能，观察软件是否崩溃，是否出现缓冲区溢出或其他不可取和（或）不可预知的结果。

                *   步骤

                    *   突变Mutation模糊测试，从软件实际操作获取输入值，然后操纵（或变异）输入值来生成模糊输入。突变模糊测试可能改变输入的内容，在内容尾部追加字符串，或执行其他的数据操纵方法。

                    *   突变Mutation模糊测试

                        *   设计数据模型，基于对软件所用数据类型的理解创建新的模糊输入。

                        *   fuzz工具可根据用户使用说明，通过操纵软件输入，实现突变模糊测试自动化。

            *   接口测试

                *   接口测试依据接口设计规范评估模块的性能，以确保模块在所有开发工作完成时可以协同工作。

                *   类型

                    *   应用编程接口，Application Programming Interface，API：为代码模块之间交互提供统一方法，并通过Web服务形式向外部公开。开发人员对API进行测试，确保API实施了所有安全要求。

                    *   用户界面：User Interface，UI，包括图形用户界面(Graphic User Interface, GUI)和命令行界面。 UI 为终端用户提供与软件交互的能力。接口测试应该审查所有用户界面，以验证用户界面是否正常工作。

                    *   物理接口：存在于操作机械装置、逻辑控制器或其他物理设备的一些应用程序。软件测试人员应该谨慎测试物理接口，因为如果物理接口失效，可能导致一些潜在后果。

            *   误用案例测试

                *   一些应用程序存在明显的说明示例，展示软件用户可能尝试错误使用该应用程序。

                *   软件测试人员使用一种称为误用例测试的过程，评估软件是否存在与这些已知风险相关的漏洞。

                *   在误用例测试过程中，测试人员首先列举已知误用例。然后，尝试通过手工或自动化攻击的方法，尝试利用这些误用例来测试应用程序。

            *   测试覆盖率分析，类型

                *   分支覆盖率：在所有 if else 条件下，每个 if 语句是否已被执行？

                *   条件覆盖率：在所有输入集合下，代码中每个逻辑是否已被测试？

                *   函数覆盖率：代码中每个函数是否已被调用并返回结果？

                *   循环覆盖率：在导致代码执行多次、一次或零次的条件下，代码中每个循环已被执行？

                *   语句覆盖率：测试期间，是否已运行过每行代码？

            *   综合交易：通过脚本允许系统的测试关键服务的行为和性能

        *   漏洞攻击模拟

        *   实施安全管理流程

            *   满足这种需求的安全管理审查包括日志审查、账户管理、备份验证、关键性能和风险指标。每项审查都应遵循一个标准化流程，包括审查完成后的管理层批准。

            *   日志审查：安全信息和事件管理(Security Information and Event Management, SIEM)工具包可在这些过程中起到重要作用，使日志审查的许多常规工作实现自动化。

                *   这些工具包利用许多设备、操作系统和应用程序中存在的 syslog 功能来收集信息。

                *   一些设备（包括 Windows 系统）可能需要安装第三方客户端来增加对 syslog 的支持。

                *   管理员可通过 Windows 组策略对象(Windows Group Policy Objects, GPO)来部署日志策略，

                *   也可通过在整个组织中部署和实施标准策略的其他机制来实现。

                *   日志系统还应该利用网络时间协议(NTP) ，确保向 SIEM 发送日志记录的系统和 SIEM 本身的时钟是同步的

        *   网站监测：类型

            *   被动监控：在经网络传输或抵达服务器的过程中，通过捕获发送到网站的实际网络流量，进行分析。被动监测提供真实监测数据，帮助管理员深入理解网络上正在发生的事情。真实用户监控(Real User Monitoring, RUM)是一种被动监测的变体，监测工具重组单个用户的活动，追踪其与网站的交互。

            *   综合监测（或主动监测）：是对网站执行伪造的事务活动，从而评估其性能。综合监测可以是从站点请求一个页面来确定响应时间那么简单，也可能执行复杂的脚本来确认事务活动的结果。

        *   帐号管理

            *   账户管理审查(Account Management Review)确保用户仅保留被授予的权限，并不发生未授权的修改

            *   账户管理审查可以是信息安全管理人员或内部审计员的一项职能。

            *   通用步骤

                *   管理人员要求系统管理员提供具有特权权限的用户列表及特权。管理人员可在检索此列表时监测管理员，以避免篡改。

                *   管理人员要求特权审批机构提供授权用户的列表及其分配的权限。

                *   管理人员对这两份清单进行比较，确保只有经授权的用户才能保留对系统的访问权限，并且每个用户的访问权限不超过其授权。

            *   许多身份和访问管理(Identity and Access Management, IAM)供应商可提供账户审查工作流程提示管理员审查、维护用户账户的文档并提供说明审查已完成的审计踪迹(audit trail)

        *   备份验证：这个过程可能涉及审查日志、审查散列值或请求系统或文件的实际恢复。

        *   关键绩效和风险指标：安全管理人员还应持续监测关键绩效和风险指标

    *   6.3、安全评估和测试、审计基本概念

        *   目的：定期验证组织是否已采取足够的安全控制，以及这些安全控制是否正常运行并有效地保护信息资产

        *   安全测试

            *   安全测试是验证某项控制措施是否正常运行，内容

                *   自动化扫描

                *   工具辅助的渗透测试

                *   试图破坏安全的手动测试

            *   应该定期执行

            *   考虑的因素

                *   安全测试资源的可用性

                *   待测控制措施所保护系统及应用程序的重要性

                *   待测系统及应用程序所包含信息的敏感性

                *   执行控制措施的机制出现技术故障的可能性

                *   关乎安全的控制措施出现错误配置的可能性

                *   系统可能遭受攻击的风险

                *   控制措施配置变更的频率

                *   技术环境下可能影响控制措施性能的其他变更

                *   执行控制措施测试的难度及时间

                *   测试对正常业务操作的影响

        *   安全评估

            *   安全评估是对系统、应用程序或其他带测的安全性进行全面审查

                *   风险评估

                *   识别漏洞

                *   提出修复建议

            *   主要工作成果通常是向管理层提交的评估报告，报告包括以非技术语言描述的评估结果，并通常以提高待测环境安全性的具体建议作为结尾

            *   NIST SP 800-53，用于帮助组织评估其信息系统的安全性，三类措施：技术、管理和物理。

                *   规范

                    *   是与待审计系统有关的文档。规范通常包括政策、规程、要求、详细及设计

                *   机制

                    *   机制是信息系统中用于满足规范的控制措施

                    *   机制可以基于硬件、软件或固件

                *   活动：是在信息系统中人员所采取的行动

                    *   执行备份

                    *   导出日志

                    *   账户审查

                *   人员：执行规范、机制及活动的人员

        *   日志管理

            *   过程

                *   Generating Log产生日志

                *   Transmitting Log传送日志

                *   Storing Log存储日志

                *   Analyzing Log分析日志

                *   Disposing Of Computer Security Log Data废弃计算机安全日志数据

            *   防止日志被篡改

                *   日志泄露或完整性破坏产生严重的后果

                *   存储和传输时实施保障机制

                *   措施

                    *   远程日志

                    *   单向通信

                    *   复制

                    *   一次性写入介质

                    *   加密哈希链

            *   日志的类型

                *   客户机请求和服务器响应日志

                *   账号信息，比如成功和失败认证尝试

                *   使用率信息，比如在特定时间段内发生的交易数量

                *   重大操作行动，比如应用启动和停止、应用失败和重大应用配置变更

    *   6.4、收集安全过程数据

        *   账号管理

            *   清理过期帐号

            *   定期审查权限

            *   管理措施

                *   攻击者途径

                    *   盗用现有特权帐号

                    *   创建新的特权账户

                    *   提升普通账户的权限

                *   增加账户：流程，AUP(Acceptable Use Policy，约束策略)，是第一道有效防线

                *   修改账户

                    *   防止权限积累

                    *   禁止使用根账户：sudo root

                *   暂停账户

                    *   解雇

                    *   临时工，缺勤

                    *   到了账户默认失效期

        *   管理审查和批准

            *   管理评审是高级管理层的正式会议，用于确定管理系统是否有效实现了目标

                *   这是管理评审必须包含组织中所有关键决策者的主要原因

                *   高层参与方式给予ISMS合法性和权力

            *   高层批准

                *   批准整个建议

                *   批准建议但做些修改

                *   拒绝建议

                *   让ISMS小组提供更多支持数据或重新设计选项

        *   关键绩效和风险指标

            *   遗留漏洞的数量、修复漏洞的时间、漏洞/缺陷重现、被盗用账户的数量、在移植到生产环境前扫描过程中检测到的软件缺陷数量、重复审计的结果、尝试访问已知恶意站点的用户

            *   术语

                *   关键绩效指标KPI：是显示ISMS绩效特别重要的指标

                *   关键风险指标KRI：能够告诉我们根据风险偏好我们当前所处的位置

        *   备份验证数据，对备份数据进行验证

        *   培训和意识

            *   安全意识培训

                *   社会工程

                    *   假冒

                    *   战争拨号：允许攻击者和管理员拨打大量号段的电话号码，搜索可用的调制解调器

                *   上网安全，偷渡下载

                *   数据保护

                *   评估安全文化

            *   专业技能培训

        *   灾难恢复DR和业务连续性BC

            *   需要对灾难恢复计划进行定期测试和维护，测试类型

                *   通读测试

                    *   通读测试是其中最简单的，但也是最重要的一种测试。在这类测试中，只需要向灾难恢复团队成员分发灾难恢复清单的副本，并要求他们审查。

                    *   目标

                        *   清单确保关键人员意识到他们的职责并定期复习知识。

                        *   为人员提供了审查清单中过时信息的机会，并根据组织的变化更新需要修改的内容。

                        *   在大型组织中，清单可帮助标识这样的情况：重要的人员已经离开公司，并且没有人为重新分配他们的灾难恢复职责而负责！这也是为什么灾难恢复职责应该包含在岗位描述中的原因。

                *   结构化演练

                    *   结构化演练执行进一步的测试。在这种经常称为“桌面练习”的测试类型中，灾难恢复团队成员聚集在一间大会议室中，不同的人扮演灾难发生时的不同角色。通常，确切的灾难情景只有主持人知道，他在会上向团队成员描述具体情况。然后，成员通过参考他们的灾难恢复计划对特定的灭难进行讨论，进而得出适当的响应办法。

                *   模拟测试

                    *   模拟测试与结构化演练类似。模拟测试向灾难恢复团队成员呈现清景并要求他们做出适当的响应措施。与前面讨论的测试不同，其中某些响应措施随后会被测试。这种测试可能会中断非关键的业务活动并使用某些操作人员。

                *   并行测试

                    *   并行测试表示下一个层次的测试，涉及将实际人员重新部署到替换的恢复场所并实施场所启用过程。被重新部署到该场所的员工，以灾难实际发生时的方式履行他们的灾难恢复职责。唯一的差别在于不会中断主要设施的运营，这个场所仍然处理组织的日常业务。

                *   完全中断测试

                    *   完全中断测试与并行测试的操作方式类似，但涉及实际关闭主场所的运营并将其转移至恢复场所。这类测试有很大的风险，因为它们要求停掉主站点的操作，并转移到恢复站点。测试完成后，在主站点执行恢复操作的反向过程。由于这个原因，完全中断测试非常难以安排，通常会遇到来自管理层的阻力。

            *   区别

                *   业务连续性计划BCP：确保组织的关键业务流程不间断，或在严重事件后能够快速恢复

                *   灾难恢复计划DRP：确保能够支持关键业务流程的信息系统持续运行，或在发生灾难时能够快速恢复

        *   信息安全持续监控(ISCM)：维持对信息安全、脆弱性和威胁的持续关注，以便支持组织的风险管理决策

    *   6.5、分析测试输出并生成报告

        *   补救

        *   异常处理

        *   道德披露

    *   6.6、执行或协助安全审计

        *   外部

        *   内部

        *   第三方，审计标准的陈述 (SAS) 70

            *   Type 1 Reports 1类报告覆盖设计的时间点报告，对用户和他们的审计师的详细报告

            *   Type 2 Reports 2类报告覆盖设计和运作有效性的时间段报告，对用户，他们的审计师与特定方面的详细报告

            *   SOC 3 (有时也被称为SysTrust, WebTrust, 或Trust Services 报告)，可以选择使用网站印章，来广泛分发的更短报告

        *   审计流程

            *   确定目标，其他一切取决于目标

            *   引入合适的部门领导，确保识别和解决业务需要

            *   确定范围

            *   选择审计团队

            *   规划审计

            *   执行审计，记录偏差

            *   记录结果

            *   将结果传到到合适的领导

        *   合规性检查（Compliance Checks）

            *   合规性检查是受监管公司安全测试和评估计划的重要组成部分。这些检查验证合规计划中列出的所有控制措施是否正常运行并有效满足监管要求。定期执行这些检查可保持组织合规计划的健康并避免不可预见的监管问题。