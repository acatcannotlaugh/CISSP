*   安全架构和工程

    *   3.1、利用安全设计原则研究、实施和管理工程过程

        *   威胁建模

            *   *   ![](https://api2.mubu.com/v3/document_image/23041862_59708597-3d32-4751-e4aa-39b92ac31cd2.png)

        *   最小特权

        *   纵深防御

        *   默认安全配置：默认设定往往让攻击者不费吹灰之力就发现并恶意利用设备。永远不要假设任何产品的默认安全配置是安全的。

        *   失效安全：故障发生后，系统或环境对故障的处理方式非常重要

            *   ![](https://api2.mubu.com/v3/document_image/aae11ce7-1db0-4c81-a381-9ead867fe53a-23041862.jpg)

            *   概念

                *   软失效（fail-soft）软失效是指允许系统在一个组件发生故障后继续允许；该方案不会导致整个系统失效

                *   失效安全 （fail-safe）如果产品会影响物理世界，则人的生命和安全是需要有限考虑的因素，这种人类保护优先的设计被称为失效保障。背后的理念是发生故障时，系统、设备或产品将会还原到一种保护人员健康和安全的状态。失效保障太平门在发生紧急情况时会变得很容易打开，以便人员逃离建筑物，但是这也以为着为了人员安全而牺牲资产保护。

                *   失效打开 （fail-open）失效打开状态以牺牲保密性完整性为代价来保护可用性。

                *   失效关闭 （fail-closed）失效关闭状态则是以牺牲可用性来保护保密性和完整性。遵循失效安全、失效关闭和失效保障规程的数字环境事件的另一个示列是，操作系统遇到处理或内部隔离违规时，会终止所有执行，然后发起重启。这种机制在windows中被称为停止错误或蓝屏死机（BSoD）

            *   异常处理（exception handing）：try...catch语句的目的是迅速处理错误

        *   职责分离（Separation of Duties，简称 SOD）是一种安全原则，它要求将一项任务的不同部分分配给不同的人员或团队，以确保没有一个人或团队可以单独完成整个任务。

        *   保持简单

            *   鼓励开发人员避免把环境、机构或产品设计得过于复杂。

            *   类似观点

                *   不自我重复 （DRY）这一理念主张不在多处重复相同的代码，从而消除软件中的冗余，否则在需要更改代码的时候，会增加难度。

                *   计算极简主义 ：编写代码时使其尽可能少用使件和软件资源

                *   最低效能规则：使用适合所需解决方案的最低耗能编程语言。

                *   更坏的就是更好的（新泽西风格），软件的质量不一定随着能力和功能的提高而提升

                *   你不需要它（YAGNI），程序员应该在真正需要的时候添加能力和功能

            *   零信任

                *   零信任（zero trust）不对机构内部的任何东西自动予以信任，永不信任，始终验证。

                *   组件

                    *   微隔离（Microsegmentation）是一种网络安全技术，它将网络分割成更小的、更安全的区域，以减少网络攻击的影响范围。

                    *   IAM身份与访问管理：是对用户进行身份验证和授权，以确保只有经过授权的用户才能访问特定的资源或执行特定的操作。

                    *   软件定义边界SDP（Software-Defined Perimeter）是一种安全的网络访问控制技术，它通过使用身份验证和加密技术来确保只有经过授权的用户和设备可以访问特定的网络资源。

                *   NIST SP 800-207：零信任架构。该指南提供了零信任架构的定义、原则、模型和实施指南，以帮助组织更好地保护其网络和数据免受网络攻击。

        *   通过设计保护隐私

            *   在产品的早期设计阶段就把隐私保护机制集成到产品中，而不是在产品开发结束之后再尝试添加。

            *   七大原则：

                *   主动而非被动，预防而非修复

                *   以默认方式保护隐私

                *   隐私嵌入式设计

                *   所有功能，正和而非零和

                *   端到端安全，全生命周期保护

                *   可见性和透明性

                *   尊重用户隐私

        *   信任但要验证

            *   这种安全保护方法不仅使组织容易遭受内部人员攻击，而且会使入侵者能在机构的内部系统之间轻松横向移动。

            *   由于现代威胁增长快速且变化无穷，“信任但要验证“安全模型已不能满足要求。如今，大多数安全专家都建议依照零信任模型设计机构的安全防护。

        *   共担责任

            *   共担责任（shared responsibility）是安全设计的原则，表明任何机构都不是孤立运行的

            *   关注

                *   机构里的每个人都负有一定的安全责任

                *   机构对利益相关方负有作出周密安全决策以保持机构可持续发展的责任

                *   与第三方合作时，尤其是与云提供商合作时，每个实体都要清楚自己在执行正常操作和维护安全方面所应承担的那部分共担责任。这就是人们常说的云共担责任模型

                *   当意识到新漏凋和新威胁的存在时，我们应该负责地将信息披露给相关供应商或信息共享中心（也叫威胁情报来源或服务）

        *   封闭系统与开放系统，开源与闭源

    *   3.2、了解模型的节本概念，可信计算基

        *   可信计算基（trusted computing base,TCB）

            *   设计原则是硬件，软件和控制的集合体，他们是协同工作，构成了执行安全策略的可信根基。TCB 的主要目的是确保计算机系统的安全性，防止未经授权的用户或恶意软件对系统进行攻击或篡改。

            *   组件

                *   安全边界

                    *   系统的安全边界（security perimeter）是一个假象的边界，可将TCB与系统的其余部分分隔开来

                    *   TCB若要与系统的其余部分通信，则必须创建安全信道，也叫可信路径（trusted path）

                *   参考监视器（reference monitor）

                    *   TCB中负责在授权访问请求之前验证对每个资源的访问部分被称作参考监视器（reference monitor）

                    *   参考监视器其实是TCB的访问控制执行者

                    *   TCB中用于执行参考监视器功能的组件集合被称为安全内核（security kernel）

        *   状态机模型

            *   状态机模型描述了无论处于什么状态始终安全的系统

            *   状态(state)是特定时刻的系统快照

        *   信息流模型

            *   信息流模型（information flow model）专注于控制信息的流动

            *   信息流动模型的设计往往可以在不同安全级别之间防止未经授权、不安全或限制的信息流

            *   BLP用于描述计算机系统中的安全策略和访问控制。

        *   无干扰模型（noninterference model）

            *   无干扰模型大致基于信息流模型

            *   无干扰模型关注的并不是信息流，而是较高安全级别主体的动作会对同状态或较低安全级别主体的动作产生的影响

            *   组合理论

                *   级联（cascading）一个系统的输入来自另一个系统的输出

                *   反馈（feedback）一个系统向另一个系统提供输入，由后者进行角色互换（即A系统首先为B系统提供输入，然后B系统向A系统提供输入）

                *   连接（hookup）一个系统在把输入发送给另一个系统的同时还将其发送给了外部实体。

        *   获取-授予模型（take-grant model）

            *   用一个定向图规定应该怎样把权限从一个主体传递给另一个主体或者从另一个主体传递给一个客体

            *   4条规则

                *   获取规则：允许主体获取客体的权限

                *   授予规则：允许主体向客体授予权限

                *   创建规则：允许主体创建新权限

                *   移除规则：允许主体移除自己拥有的权限

        *   访问控制矩阵（access control matrix）

            *   访问控制矩阵是一个由主体和客体组成的表格，表明了每个主体可对每个客体执行的操作或功能，矩阵的每列都是依照客体排列的访问控制列表（ACL）

            *   权能表

        *   Bell-LaPadula模型，禁止上读下写，模型是一种基于访问控制矩阵的模型，它将主体和客体的安全级别存储在访问控制矩阵中，并根据主体和客体的安全级别来决定是否允许访问。该模型是一种强制访问控制模型，它不允许主体自行决定是否可以访问客体，而是由系统根据安全策略来决定。

            *   ![](https://api2.mubu.com/v3/document_image/dd272b49-799c-4182-a5ec-e7bfeed9fefd-23041862.jpg)

            *   强调保密性，信息流只能写入同级或高一层级，并且只能读取同级或低一级的信息

            *   三个属性

                *   简单安全属性（simple security property）规定主体不可读取更高敏感度级别的信息（不可向上读）

                *   \*安全属性（security property）规定主体不可把信息写较低敏感度级别的客体（不可向下写）。也被称为限定属性（confinement property）

                *   自主安全属性（discretionary sercurity property）规定系统通过一个访问矩阵执行自主访问控制0

        *   Biba模型，禁止下读上写，是一种基于访问控制矩阵的模型，它将主体和客体的安全级别存储在访问控制矩阵中，并根据主体和客体的安全级别来决定是否允许访问。该模型是一种强制访问控制模型，它不允许主体自行决定是否可以访问客体，而是由系统根据安全策略来决定。

            *   ![](https://api2.mubu.com/v3/document_image/13a42e57-6157-4a8f-89c1-739da86fbde2-23041862.jpg)

            *   强调完整性，禁止修改，不能读取安全级别为“机密”或更低的客体的信息，不能写入安全级别为“机密”或更高的客体的信息。

            *   属性

                *   简单完整属性（simple integrity property）规定主体不能读取较低完整性级别的客体（不可向下读）

                *   \*完整属性（\*integrity property）规定主体不能修改较高完整性级别的对象（不可向上写）

        *   Clark-Wilson模型

            *   clark-wilson模型通过一种设计诸多方面的方法实现数据的完整性

            *   定义了每个数据项并且值允许通过一个受限或受控中间程序或接口进行修改。

            *   Clark-Wilson模型借助组织完善的事物和职责分离两项原则提供了保护完整性的有效手段。

        *   Brewer and Nash 模型

            *   他寻求创建对利益冲突概念敏感的安全域

            *   该模型还在每个冲突类别内使用数据隔离原则，从而使用户远离潜在的利益冲突情况

            *   也被成为中国墙模型

        *   Goguen-Meseguar模型：这个模型被认为是非干涉性概念理论的基础

        *   Sutherland模型

            *   Sutherland模型是一个完整性模型，专注于通过防止干扰来支持完整性

            *   使用Sutherland模型的一个常见例子是：防止屏蔽信道被用来影响进程或活动的结果

        *   Graham-Denning模型：Graham-Denning模型专注于主体和客体的安全创建和删除

        *   Harrison-RUzzo-Ullman模型：Harrison-Ruzzo-Ullhnan（HRU）模型专注于给主体分配客体的访问权限以及这些被分配权限的韧性

    *   3.3、基于系统安全要求选择控制

        *   进程限定（confmement）使进程只能对某些内存位置和资源进行读和写。也就是所谓的沙箱（sandboxing），即对进程执行最小特权原则，限定的目的是防止数据被泄露给未经授权的程序，用户，系统。

        *   进程的界限（bound）由一些限制组成，这些限制规定了进程可以访问的内存地址和资源，界限将进程的活动限定或制约在特定的区域内。

        *   隔离（isolation）

            *   当一个进程因访问界限的执行而被限定时，他就是在隔离状态下运行

            *   用来保护操作环境，操作系统内核以及其他独立应用程序。

        *   信任与保护

            *   保证（assurance）是指满足安全需求的可信程度

            *   信任是安全机制，功能或能力的提现

        *   标准 CC，信息技术安全性评估通用准则（Common Criteria for Information Technology Security Evaluation，简称 CC）

            *   通用准则（common criteria,CC）定义了测试和确认系统安全能力的各种级别，级别上标注的数字标识执行了哪种测试和确认

            *   ISO15408：标准包括一系列安全要求和评估方法，这些要求和方法涵盖了多个方面，包括访问控制、身份验证、加密、审计、漏洞管理等。该标准还提供了一种认证机制，以确保产品和系统符合标准要求。目标是促进信息技术产品和系统的安全开发和部署，提高信息技术产品和系统的安全性和可靠性。

            *   两个要素

                *   保护轮廓（protection profile,PP）为将接收评估的产品（即受评估对象）规定了安全要求和保护措施，可以把这些要求和保护措施视为客户的安全期望或客户“想要的东西”。

                *   安全目标（security targets,ST）规定了应被供应商纳入受评估对象的安全性能，可以把安全目标视为已经执行的安全措施或供应商“将提供的东西”。

            *   7个EAL，Evaluation Assurance Level 指评估保证级别，是评估信息技术产品和系统安全性的一个指标，它表示了产品或系统的安全级别。

                *   EAL1功能测试Functionally Tested：该级别表示产品或系统已经进行了基本的功能测试，以确保其满足最低的安全要求。

                *   EAL2结构测试（Structurally Tested）：该级别表示产品或系统已经进行了结构测试，以确保其满足特定的安全要求。

                *   EAL3系统性测试和检查（Methodically Tested and Checked）：该级别表示产品或系统已经进行了系统地测试和检查，以确保其满足更高的安全要求。

                *   EAL4系统性设计、测试和审查（Methodically Designed, Tested, and Reviewed）：该级别表示产品或系统已经进行了系统地设计、测试和评审，以确保其满足更高的安全要求。

                *   EAL5半正式设计和测试（Semiformally Designed and Verified）：该级别表示产品或系统已经进行了半形式化设计和验证，以确保其满足更高的安全要求。

                *   EAL6半正式验证、设计和测试（Formally Verified Design and Tested）：该级别表示产品或系统已经进行了形式化验证设计和测试，以确保其满足更高的安全要求。

                *   EAL7正式验证、设计和测试（Formally Verified Design and Tested）：该级别表示产品或系统已经进行了形式化验证设计和测试，以确保其满足最高的安全要求。

        *   操作授权：就许多环境而言，必须得到正式批准才能将有安全保障的设备用于IT操作的目的

    *   3.4、了解信息系统(IS)的安全能力

        *   内存保护：所涉及主体包括隔离、虚拟内存、分段、内存管理、保护环以及缓冲区（内存）溢出保护。

        *   虚拟化：虚拟化技术用于在一台主机的内存中运行一个或多个操作系统，或运行与主机操作系统不兼容的应用程序

        *   可信平台模块（Trusted Platform Module，TPM）

            *   即是主板上密码处理芯片的规范，也是此规范执行方案的称谓

            *   TPM芯片通常用于为硬件支持的或操作系统执行的本地有储设备加密系统存储和处理密码秘钥。

            *   硬件安全模块（HSM）就是TPM的一个例子，HSM是一种密码处理器，用于管理/存储数字加密秘钥，提升，密码运算的速度，支持数据更快的数字签名以及改进身份认证。

        *   受约束或受限制接口（constrained or restriced interface）在应用程序内执行，指在使用用户只能按自己的权限执行操作或查看数据。

        *   容错（fault tolerance）指系统虽然发送故障，但仍能继续允许的能力

    *   3.5、评价并降低安全架构、设计和解决方面的漏洞

        *   基于客户端的系统

            *   移动代码 applet

                *   applet是服务器发送给客户端以执行某些操作的代码对象

                *   例子

                    *   java applet 沙箱

                    *   activeX

            *   本地缓存

                *   arp缓存

                *   dns缓存

                *   临时互联网文件

        *   基于服务器的系统：负载均衡（load balance）

            *   出口负载均衡

            *   服务器负载均衡

        *   并行计算（parallel computing）

            *   把大型任务划分成较小元素，然后把每个子元素分配给不同的处理子系统进行并行计算

            *   处理器类型

                *   对称多处理（symmetric multiprocessing,SMP）各个处理器不仅共享一个公共操作系统，还共享一个公共数据总线以及内存资源

                *   非对称多处理（asymmetric multiprocessing,AMP）

                    *   各个处理器往往彼此独立工作，每个处理器通常有自己的操作系统和/或任务指令集以及专用的数据总线和内存资源

                    *   AMP有一种标题叫做大规模并行处理（massive allel processing,MMP），其中大量AMP系统被连接在一起，跨多个链接系统的多个进程共同处理一项主任务。

        *   网格计算（grid computing）是一种并行分布式处理形式，他对大量处理节点进行松散的分组，使其共同去实现一个特定处理目标

        *   对等网络（peer-to-peer,P2P）

            *   是在伙伴之间共享任务和工作负债的联网和分布式应用解决方案。

            *   P2P解决方案的安全问题包括盗印受版权保护材料的明显诱惑，窃听分布式内容的能力、集中控制/监督/管理/过滤的缺乏以及服务耗尽所有可用宽带的可能性。

        *   数据库系统

        *   密码系统

        *   工业控制系统-组件

            *   分布式控制系统（distribution control system,DCS）

            *   可编程逻辑控制器（programmable logic controller,PLC）

            *   检测控制和数据采集（supervisory control and data acquisition，SCADA）

        *   基于云的系统

        *   分布式系统（distributed system）或分布式计算环境（distributed computing env onment,DCE）是协同支持一个资源或提供一项服务的一组单个系统集合

        *   物联网（internet of things,IOT）属于智能设备的一个类别，他们与互联网连接，可为装置或设备提供自动化，远程控制或人工智能处理

        *   微服务（microserice）

            *   是基于web解决方案的一个新型特性，属于SOA的衍生品。

            *   微服务的创建往往是为了通过独立部署的服务提供特定用途的业务功能

        *   容器化或操作系统虚拟化（OS-virtualization）基于一个概念：在虚拟机中消除操作系统的重复元素。该方法把所有的应用程序都放进一个容器，而容器中只包含支持被封闭的应用程序真正需要的资源，然后把公共或共享的操作系统纳入管理程序

        *   无服务架构（serverless architecture）无服务架构是一种云计算概念，其中代码由客户端管理，平台（即支持性硬件和软件）或服务器由云服务提供商（CSP）管理

        *   嵌入式系统（embedded system）是为提供自动化、远程控制/或监控而被添加到现有机械或电气系统中的任何形式的计算组件

        *   高性能（hig-performance computing,HPC）系统

            *   指专用于极高速度执行复杂运算或数据操控的计算平台

            *   HPC解决方案由三个主要元素组成：计算资源，网络能力和存储容量

            *   实时操作系统（real-time operating system,RTOS），经过设计在数据到达系统时以最小时延或延迟对他们进行处理或处置

        *   边缘计算系统（edge computing）让数据与计算资源尽可能靠近，在最大限度减少时延同时优化宽带利用率的一种网络设计理念

        *   虚拟化系统

            *   *   ![](https://api2.mubu.com/v3/document_image/7fb4ab22-1c38-4517-9387-50a21d4d314c-23041862.jpg)
            *   *   ![](https://api2.mubu.com/v3/document_image/9f616227-9e4d-4a14-a6af-249717f48e60-23041862.jpg)
            *   *   ![](https://api2.mubu.com/v3/document_image/822ac350-9b2e-45f1-afa9-95790f7fac2c-23041862.jpg)

        *   移动设备管理

            *   移动设备管理（mobile device management，MDM）

            *   UEM：统一端点管理（Unified Endpoint Management）

            *   设备身份认证（device authentication）

            *   全设备加密（full-deivice encryption,FDE）

            *   通信保护

            *   远程擦除（remove wipe）

            *   设备锁定（device lockout）

            *   屏幕锁（screen lock）

            *   全球定位系统（global positioning system,GPS）

            *   内容管理：内容管理是在控制移动设备以及对被托管在公司系统上的内容的访问，并控制人员对保护在移动设备上的公司数据的访问

            *   应用程序控制（application control）应用程序运行列表（application allow listing）（以前白名单）是一个禁止执行未经授权软件的安全选项，允许列表也被称为默认拒绝（deny by default）或隐式拒绝（implicit deny）

            *   推送通知（push notification）服务能够向你的设备发送信息

            *   第三方应用商店

            *   存储分段（storage segmentation）用于在存储介质上按各种类型和数值对数据进行人为划分

            *   资产跟踪和存货控制

            *   可移动存储

            *   连接方法：RFID、NFC、IEEE 802.11、IEEE 802.15

            *   禁止无用性能

            *   生根或越狱：生根（rooting）或越狱（jailbreaking）是苹果设备的特殊用于，打破移动设备引导加载程序数字权限管理（DRM）的安全保护并以根或全系统特权操作设备的行为

            *   旁加载（sideloading）指通过某种形式的文件传输或USB存储介质把安装程序文件待到设备上来安装某款应用程序的行为

            *   凭证管理：可提供一种安全存储大量凭证集的方法

            *   自定义固件

            *   运营商解锁

            *   固件无线更新

            *   密钥管理

            *   手机短信

        *   移动设备部署策略

            *   自带设备（bring your own device,BYOD）

            *   公司拥有，个人使用（corporate-owned,personally enabled,COPE）

            *   自选设备（choose your won device,CYOD）

            *   公司拥有移动设备战略略(corporate-owned mobile strategy, COMS)或公司拥有仅用于业务(corporate-owned, business-only, COBO) 战略是指公司购买可支持安全策略合规的移动设备。

            *   数据的拥有权

            *   对拥有权的支持

            *   补丁和更新管理

            *   安全产品管理：移动设备部署策略应该规定是否要在移动设备上安装杀毒软件，反恶意软件，反间谍软件扫描程序，防火墙，HIDS或其他安全工具

            *   取证：移动设备部署策略应该阐明与移动设备相关的取证和调查问题。

            *   隐私

            *   列装/退役

            *   遵守公司策略

            *   用户接受

            *   网络共享（tethering），热点（hotspot）：是指将移动设备的蜂窝网数据连接和其他设备共享的行为。它可以有效地允许移动设备充当便携式无线接入点(WAP)

            *   基于移动设备的支付系统，无接触支付方式（contactless payment method）

            *   SIM克隆

        *   硬件

            *   CPU：多任务处理、多核心、多重处理、多程序设计、多线程

            *   保护环

            *   进程状态：就绪、运行、等待、管理程序状态、停止

            *   存储器

                *   只读存储器

                    *   可擦除可编程存储器

                        *   紫外线

                        *   电子可擦除可编程存储器

                    *   可编程只读存储器

                *   随机存储器

                    *   内存

                    *   缓存

                *   数据存储

                    *   主存与辅助存储

                    *   易失性存储设备与非易失性存储设备

                    *   随机与顺序

            *   发射安全

                *   法拉梯笼

                *   白噪声

                *   控制区

            *   输入输出设备：显示器、鼠标、调制解调器

            *   固件：BIOS、UEFI、更新UEFI、BIOS固件的过程被称为刷新

        *   缺陷

            *   隐蔽隧道

            *   基于设计或编码缺陷的攻击

            *   Rookit

            *   增量攻击

    *   3.6、挑选和确定密码的解决方案

        *   密码生命周期，混合加密

            *   混合加密的消息

                *   ![](https://api2.mubu.com/v3/document_image/2a3d5c86-d55d-4024-b224-4fc57561d088-23041862.jpg)
            *   混合加密的密文

                *   ![](https://api2.mubu.com/v3/document_image/b085ee53-b6a4-49f1-b87e-d921abdfbbd0-23041862.jpg)

        *   加密方法（对称加密、非对称加密、椭圆曲线、量子）

            *   分类

                *   公钥加密系统（asymmetric key algorithm）

                    *   优点

                        *   添加新用户只需要生成一个公钥-私钥对

                        *   便于从非对称系统移除用户

                        *   只需要在用户私钥失信的情况下重新生成秘钥

                        *   非对称秘钥加密可提供完整性，身份认证和不可否认性

                        *   秘钥分发简便易行

                        *   不需要预先建立通信关联

                    *   原理

                        *   ![](https://api2.mubu.com/v3/document_image/f9075e26-46ce-41cf-a44b-4c3fd47e6018-23041862.jpg)
                    *   公钥加密算法

                        *   Merkle-Hellman 背包算法是早期的另一种非对称算法，于 RSA发布的第二年被开发出来。RSA 一样，这种算法也基于进行因式分解运算的艰难性，但是它所依靠的是集合理论的一个组成部分（即超递增集）而非大素数。 Merkle-Hellman 1984年被破解，被证明无效

                        *   RSA，RSA 算法所依靠的是因式分解大素数乘积的天然计算难度。1024位强度和椭圆曲线160位长度等同 。3072位

                        *   椭圆曲线密码（clliptic curve cryptography,ECC）。256位

                        *   Diffie-Hellman秘钥交换

                        *   El Gamal

                *   对称密码系统

                    *   优点，效率高

                    *   缺点

                        *   秘钥分发是主要问题

                        *   对称秘钥加密法不提供不可否认性

                        *   算法缺乏可扩展性

                        *   秘钥必须经常重新生成

                    *   对称密码熟记表

                        *   ![](https://api2.mubu.com/v3/document_image/5b6d4eed-9f50-4712-b80f-bfe23335b347-23041862.jpg)
                    *   密码运行模式

                        *   电子密码本（Electronic Code Book，ECB）：将明文按照64位一组进行分隔，使用秘钥分别加密各个明文分组。

                            *   ![](https://api2.mubu.com/v3/document_image/406f3714-c9d7-4b3e-939c-a872b161c50e-23041862.jpg)

                            *   是最容易理解的简单模式，也是最不安全的模式。算法每次处理一个 64 位块，它只用选好的秘密密钥分别给所有的块加进行密。如果被获取到密文可根据加密值构建一个密码本，可使用密码分析进行解密。

                        *   密码块链接（Cipher Block Chaining，CBC）：将明文按照64位一组进行分隔，使用一个初始向量异或加密第一个明文分组，加密后的密文对下一个明文分组有进行异或加密。

                            *   ![](https://api2.mubu.com/v3/document_image/b2c9a6ee-54dd-4dd8-b0aa-6fd2aa0f45ec-23041862.jpg)

                            *   使用一个初始化向量进行异或加密，之后的每块未加密文本在被加密之前，都要先借助前面刚生成的密文块接受异或(XOR)运算。解密流程只需要解密密文并进行反向异或运算。错误传播是需要考虑的一个重要问题一如果一个块在传输过程中被毁坏，那么这个块以及后面的块将无法解密。错误会传递

                        *   密码反馈模式（Cipher Feedback，CFB）：将明文按照64位一组进行分隔，使用一个初始向量先进行一次加密，然后进行异或加密第一个明文分组，加密后的密文对下一个明文分组有进行异或加密。

                            *   ![](https://api2.mubu.com/v3/document_image/fc89fa1c-c499-42dd-82bd-76d2720e9561-23041862.jpg)

                            *   密码反馈模式（Cipher Feedback，CFB）是CBC模式的流密码版。CFB 采用的力式与 CBC 相同。它使用了一个 IV, 并且使用了链接。错误会传递

                        *   输出反馈模式（Output Feedback，OFB），使用一个初始化向量在给每个明文分组异或之前先进行一次加密。

                            *   ![](https://api2.mubu.com/v3/document_image/397dda90-2f6b-4fcd-bbf0-c995279a07cc-23041862.jpg)

                            *   OFB使用一个初始化向量进行加密后再和明文分组进行加密，之后的每个块加密之前初始化向量都会加密一次后再和明文分组进行加密。OFB 模式的主要优势在于，不存在链接函数，传输错误不会传播，因而不会影响后面块的解密。

                        *   计数器（Counter，CTR）模式使用了CFB，OFB模式类似的流密码。

                            *   ![](https://api2.mubu.com/v3/document_image/9e69baf7-2d35-443e-8cb6-873d342cc3be-23041862.jpg)

                            *   但是CTP模式的初始化向量利用一个简单的计数器CTR 模式并非根据以前的种子值结果为每次加密/解密运算创建种子值，而是利用一个简单的计数器在每次明文分组加密运算前进行增量后再进行异或运算。

                        *   Galois/计数器模式，采用标准 CTR 加密模式，并添加了数据真实性控制，可确保接收方所接收数据的完整性

                        *   带密码块链接消息验证码的计数器模式（CCM），CCM 密码把用于保证保密性的计数器(CTR)模式与用于保证数据真实性的密码块链接消息验证码(CBC-MAC)算法融为一体。

                    *   常见算法

                        *   DES

                        *   三重DES，4种不同变体

                            *   EEE3

                            *   EEE2

                            *   EDE3

                            *   EDE2

                        *   IDEA：IDEA 算法使用 128 位的密钥，将明文分成 64 位的块，然后对每个块进行 8 轮迭代运算。在每一轮迭代中，IDEA 算法使用不同的子密钥来对明文进行加密。这些子密钥是通过对主密钥进行迭代运算生成的。

                        *   Blowfish：使用 64 位分组，允许密钥长度变化（其中最短为相对不太安全的 32 位，最长为极强的 448 位）

                        *   Skipjack：由美国NAS设计的对称分组密码算法，被美国政府在联邦信息处理标准(FIPS)185“ 托管加密标准”(EES) 中批准使用。该算法使用 64 位分组和 80 位固定长度的密钥。

                        *   Rivest Cipher4（RC4）：RC4 算法的设计简单高效，它使用一个 256 字节的密钥生成一个伪随机数序列，然后将明文与该伪随机数序列进行异或运算得到密文。

                            *   一种流密码

                            *   允许使用 40~2048 位的长度可变密钥

                            *   RC4 之所以被使用得这么普遍，是因为它被集成到有线等效隐私wep、wi-Fi 保护访问(WPA) 、安全套接字层(SSL)和传输层安全(TLS)等协议之中

                        *   RC5是一种块大小可变（32、64、128位）的块密码，所用秘钥大小为是 0 到 2040 位之间的任意整数。

                        *   Rivest Cipher6（RC6）：RC6 是作为 RC5 的下一个版本而开发的一种块密码。它采用 128 位块大小，允许使用128 192 256 位对称密钥。

                        *   AES：“高级加密标准”(AES)密码允许使用 种密钥强度： 128位 192位 256 位。

                        *   CAST算法是另一个被集成到一些安全解决方案中的对称密钥块密码家族。CAST算法使用Feistel网络，有两种形式

                            *   CAST-128在64位明文块上使用12或16轮festel网络加密，密钥大小在40到128位之间。

                            *   CAST-256在128位明文块上使用48轮加密，密钥大小为128、160、192、224或256位

                        *   Twofish

                            *   预白化处理(prewhitening)

                            *   白化后处理(postwhitening)

                    *   对称密码协调窃听

                        *   ![](https://api2.mubu.com/v3/document_image/5a19852b-882b-4e0e-b943-d91b7f49536c-23041862.jpg)

            *   数据状为态

                *   静态数据（data at rest），被存储的数据，是指驻留在一个永久位置上等待被访问的数据。保存在硬盘、备份磁带、云存储服务、USB 装置和其他存储介质中的数据都属于静态数据。

                *   动态数据（data in motion），线路上的数据，是指正在两个系统之间通过网络传送的数据。动态数据可能通过公司网络、无线网络或互联网传送。

                *   使用中的数据（data in use），是指保存在计算机系统活跃内存中，可供系统中运行的进程访问的数据

        *   公钥基础架构（PKI）

            *   证书遵守X.509版本

            *   组成

                *   认证机构CA：负责颁发和管理数字证书的机构。CA 验证证书申请者的身份，并颁发包含申请者公钥的数字证书。

                *   注册机构（RA）：负责审核证书申请者的身份，并将审核结果提交给 CA。RA 可以是一个独立的机构，也可以是 CA 的一部分。

                *   证书库：存储数字证书的数据库。证书库可以是集中式的，也可以是分布式的。

                *   证书撤销列表（CRL）：列出已经被撤销的数字证书的列表。CRL 由 CA 发布，并定期更新。

                *   终端用户：使用数字证书进行身份认证和加密通信的用户。

            *   原理

                *   ![](https://api2.mubu.com/v3/document_image/2cad8e31-15dc-4d89-8988-3e8b7f5fe557-23041862.jpg)
                *   ![](https://api2.mubu.com/v3/document_image/9cb9e168-acb0-426f-8a5a-0686c0e27c34-23041862.jpg)

        *   秘钥管理实践

        *   不可否认性，数字签名digitial signature 标准和数字证书

            *   FIPS 186-4规定的数字签名算法DSA

            *   ANSIX9.31规定的Rivest-Shamir-Adleman（RSA）算法

            *   ANSIX9.62规定的椭圆曲线DSA（SCDSA）

        *   完整性

            *   完整性确保数据在没有在未经授权的情况下被更改

            *   哈希函数

                *   五个基本要求

                    *   输入可以是任何长度

                    *   输出有一个固定长度

                    *   哈希函数的计算对任何轮入而言都是相对容易得

                    *   哈希函数是单项的（意味着很难根据输出确定输入）

                    *   哈希碰撞

                *   算法

                    *   安全哈希算法（SHA-2），四种变体

                        *   SHA-256：512位块大小生成256位消息摘要

                        *   SHA-224：借用了SHA-256哈希的缩减版，用512位块大小生成224位消息摘要

                        *   SHA-512：1024位块大小生成512位消息摘要

                        *   SHA-384：借用了SHA-512哈希的缩减版，用1024位块大小生成384消息摘要

                    *   消息摘要5（MD5）不安全。

                    *   HAVAL：可变长度哈希(HAVAL)是MD5的修订版。HAVAL使用1024 位块，产生128 160 192 224和256 位哈希值。

                    *   RIPE消息摘要（RIPEMD）：RIPEMD-160 取代了 RIPEMD-128, 至今一直被认为安全，是被使用得最普遍的RIPEMD 变体。它生成 160 位哈希值。

                    *   *   ![](https://api2.mubu.com/v3/document_image/723cc81d-6ca7-42ab-9fca-badf3c3d98b8-23041862.jpg)

        *   科克霍夫原则：则(Kerckhoffffs's principle, 也叫科克霍夫假设）是说，只要密钥不被别人掌握，那么即便有关密码系统的一切都是公开的，密码系统也应该是安全的。

        *   密码数学

            *   布尔数学

            *   逻辑运算

            *   模函数

            *   单向函数

            *   Nonce：是一个随机数，可在数学函数中充当占位符变量。nonce 每次被使用时都必须是一个唯一的数。比较有名的 nonce 例子之一是初始化向量(IV) ，这是一个随机位串，长度与块大小相同，针对消息执行 XOR 操作。

            *   零知识证明（zero-knowledge proof），密门：一个人想要证明自已知道一个事实（如口令或密钥），但又不想把这个事实向另外一个人公开。这可以通过复杂的数学运算实现，如离散对数和图论。

            *   分割知识（split knowledge）

                *   当执行某项操作所要求的信息或权限被分散到多名用户手中时，任何一个人都不会具有足够的权限来破坏环境的安全。这种把职责分离和双人控制融于一个解决方案的做法叫分割知识

                *   密钥托管(keyescrow)概念是体现分割知识的最佳例子。采用密钥托管后，密码密钥会被交给一个第三方妥善保存。当满足某些条件时，第三方可以用托管密钥来恢复授权用户的访问权限或自行解密资料。这个第三方叫恢复代理(recovery agent)

                *   N之取 M控制(M of N Control)要求代理总数N中至少有M个代理同时在场时才能执行高安全级任务。

        *   密码分类

            *   位移密码（transposition cipher），通过一种加密算法重新排列明文消息的字母，形成密文消息。解密算法只需要逆向执行加密位移便可恢复原始消息。

            *   替换密码（substitution cipher）通过加密算法用一个不同的字符替换明文消息的每个字符或位。

            *   单次密本（one-time pad）

                *   单次密本为明文消息中的每个字母使用一个不同的替换字母表。

                *   单次密本也叫 Vemam 密码

                *   特点

                    *   单次密本必须随机生成

                    *   单次密本必须处于物理保护之下，以防泄露

                    *   每个单次密本必须只使用一次

                    *   秘钥必须至少被加密的消息一样长

            *   运动密钥密码（running key cipher）

                *   这种密码也叫书密码（book cipher）

                *   加密秘钥与消息本身一样长，而且往往选自一本普通图书，一张报纸，一本杂志

            *   块密码（block cipher）：是一种对称加密算法，它将明文消息分成固定大小的块（通常是 64 位或 128 位），然后对每个块进行加密。块密码的安全性取决于密钥的长度和算法的复杂度。

            *   流密码（stream cipher）：一种对称加密算法，它将明文消息转换为一系列随机的位流（称为密钥流），然后通过将明文消息与密钥流进行异或运算来生成密文消息。流密码的安全性取决于密钥流的随机性和不可预测性。

                *   一次在消息（或消息流）的一个字符或一个位上运行。

                *   凯撒密码也是流密码的一个例子

                *   单次密本也是一种流密码

        *   新技术

            *   量子计算（Quantum computing）

            *   同态加密：（Homomorphic Encryption）是一种加密技术，它允许在加密状态下对数据进行计算，而不需要先对数据进行解密。同态加密的核心思想是将加密后的数据转换为一种可计算的格式，使得可以在加密状态下对数据进行各种计算操作，而不会泄露原始数据的内容。

            *   区块链

            *   轻量级加密，智能卡是低能源环境的另外一个例子

        *   应用密码学

            *   区块链：区块链的第一个主要应用是加密货币。区块链最初是作为比特币的基础技术发明的，允许在不使用中央集权的情况下跟踪比特币交易。通过这种方式，区块链允许存在一种没有中央监管的货币

                *   不可篡改

                *   价值的唯一性

                *   智能合约

                *   去中心去组织

            *   无线加密：WEB、WPA、WPA2

            *   硬盘加密：bitlocker、EFS、FileValut

            *   TPM

                *   TPM 是安放在设备主板上的一块芯片，可发挥诸多作用，包括保存和管理用于全硬盘加密(FDE)解决方案的密钥。

                *   TPM 只在成功验证用户身份之后向操作系统提供密钥访问权，可防止有人把硬盘驱动器从设备上拆下来并插进另一设备以访问驱动器上的数据

            *   HSM，硬件安全模块

            *   电子邮件

                *   Pretty Good Privacy，PGP

                *   S/MINE，安全／多用途互联网邮件扩展(Secure/Multipurpose Internet Mail Extensions,S/MIME)协议已经成为加密电子邮件的事实标准。 S/MIME 使用 RSA 加密算法，并且得到了业界大佬的支持，包括 RSA Security

            *   WEB，HTTPS

            *   洋葱头和暗网

                *   洋葱路由器(The Onion Router) ，它提供了一种机制，可通过加密和一组中继节点在互联网上匿名传送通信流。

                *   它依靠的是一种名为完全前向保密(perfect forward secrecy) 的技术，这种技术的多层加密可阻止中继链中的节点读取它们需要接收和转发的通信流中特定信息以外的任何信息。通过将完全前向保密与一组3个或更多的中继节点结合使用，Tor既可以匿名浏览标准互联网，也可以在暗网上托管完全匿名的网站。

            *   隐写术和水印，隐写术(steganography) 是通过加密技术把秘密消息嵌入另一条消息的技艺。隐写算法的工作原理是从构成图像文件的大量位中选出最不重要的部分并对其作出改动。

            *   联网

                *   SSH

                *   IPsec

                    *   AH

                    *   ESP

        *   公钥基础设施：是一种基于公钥加密技术的安全框架，用于管理和分发数字证书，以确保网络通信的安全性和可信性。

            *   证书

            *   认证机构CA：负责颁发和管理数字证书的机构。CA 验证证书申请者的身份，并颁发包含申请者公钥的数字证书。

            *   证书生命周期

                *   注册

                *   注销

            *   证书装订：在一定程度上减轻原始协议给发证机构带来的负担

        *   密码管理实践股规范

        *   数字签名和数字证书

            *   数字签名能提供不可否认性，可以确保消息或文档的完整性和真实性，并且可以防止中间人攻击和重放攻击。但无法保证保密性

            *   数字签名原理

                *   发送方使用私钥对消息或文档进行加密，并得到一个数字签名。

                *   发送方将数字签名与消息或文档一起发送给接收方。

                *   接收方使用发送方的公钥对数字签名进行解密，得到一个哈希值。

                *   接收方计算消息或文档的哈希值，并将其与解密得到的哈希值进行比较。

                *   如果两个哈希值相等，则说明消息或文档没有被篡改，并且是由发送方发送的。

            *   数字签名标准：FIPS 186-4 数据签名标准 DSS

                *   DSA

                *   RSA

                *   DSA（ECDSA）

        *   密码学的目标

            *   保密性

                *   对称加密

                *   公钥加密

            *   完整性：简单的完整性可通过使用加密的消息摘要来实现，这个摘要叫做数字签名

            *   身份认证：用于验证系统用户自称的身份

            *   不可否认性：向接收者保证：消息来自发送者，而且没有人冒充发送者

    *   3.7、理解密码分析的攻击方式

        *   暴力破解：暴力破解攻击是直截了当的攻击。这种攻击尝试找出密钥或口令的每种可能的有效组合。实施攻击时极力使用处理能力来系统化猜测用于加密通信的密钥。

        *   唯密文攻击：多时候可供攻击者摆弄的只有经过加密的密文消息，这种情景就是唯密文攻击(ciphertext-only attack)

        *   已知明文攻击：攻击者掌握的加密消息的副本以及用于生成密文的明文消息在已知明文攻击中，攻击者掌握了加密消息的副本以及用于生成密文（副本）的明文消息。

        *   频率分析：即统计每个字母在密文中出现的次数，被证明是有助于破解简单密码的一种技术手段。

        *   选择密文攻击：在选择密文攻击中，攻击者能够解密密文消息中被选中的部分，然后用解密了的那部分消息来发现密钥。

        *   选择明文攻击：在这种攻击中，攻击者获得与自己选中的一组明文对应的密文

        *   中间相遇：攻击者可能通过中间相遇攻击手段来击败采用两轮加密的加密算法。正是这种攻击的出现，导致作为 DES 加密可行强化版的“双重 DES" (2DES)很快被弃用

        *   实现攻击：这是探寻密码系统在执行过程中暴露的弱点的一种攻击。它着重于挖掘软件代码，其中不仅包括错误和缺陷，还涉及用来给加密系统编程的方法。

        *   边信道攻击

            *   计算机系统会生成活动的特征足迹，例如处理器利用率、功耗或电磁辐射的变化

            *   边信道攻击寻求利用这些信息监视系统活动并检索当前正在加密的信息

        *   故障注入攻击：在这些攻击中，攻击者试图通过造成某种外部故障来破坏密码设备的完整性。例如，攻击者可能会利用高压电力、高温或低温或者其他因素引发故障，从而破坏设备的安全性。

        *   计时攻击：是边信道攻击的一个例子，攻击者精确测出完成加密运算所需的时间，从中获取可用来破坏加密安全性的有关加密过程的信息

        *   彩虹表攻击：salt

        *   统计攻击：统计攻击探寻密码系统的统计学弱点

        *   中间人攻击：在中间人攻击中，一个心怀歹意之人在两个通信方之间的某一个地方拦截所有通信（包括密码会话的设定）

        *   哈希传递攻击

        *   Kerberos漏洞利用

        *   勒索软件

        *   生日攻击：生日攻击也叫碰撞攻击(collision attack)或反向哈希匹配(reverse hash matching)

        *   重放攻击：重放攻击针对的是没有采用临时保护措施的密砃算法。在这种攻击中，心怀歹意之人在通信双方之间拦截经过加密的消息（常常是身份认证请求），然后通过“重放”捕获的消息来建立一个新会话。

    *   3.8、站点与设计的安全原则

        *   安全设施计划 secure facility plan

            *   需要列出组织的安全需求，并突出用于保障安全的方法及机制

            *   该计划是通过风险评估和关键路径分析来制订的

                *   关键路径分析 critical path analysis

                    *   是一项系统性工作，用于找出任务关键型应用程序、流程、运营以及所有必要的支撑元素间关系

                    *   与关键路径分析同等重要的是针对已完成的或潜在的技术融合的评估

                *   技术融合指的是各种技术、解决方案、实用程序及系统，随时间的推移而发展、合并的趋势

            *   设计安全IT基础设施的第一步是满足组织环境及信息设备的安全要求

            *   信息安全人员应参与站点与实施的设计

            *   安全设施基于基于分层防御模型

        *   站点选择

            *   站点的位置与施工建造在整个选址过程中起至关重要的作用

            *   工业伪装 industrial camouflflage---是指通过提供一个让人信息的外表替代方案来掩盖或隐藏设施的实际功能、目标或运营任务。

        *   设施设计

            *   安全的首要任务应该始终是保护人员的生命和安全

                *   要确保所有设施设计和物理安全控制符合所有适用的法律、法规

                *   重点考虑的因素

                    *   可燃性

                    *   火警等级

                    *   建筑材料

                    *   负载率

                    *   布局

                    *   对墙、门、天花板、地板、HVAC、电力、供水、排水、燃气等项目的控制

                    *   暴力入侵、紧急通道、门禁、出入口方向、警报的使用以及传导性是其他需要重点评估的方面

            *   CPTED（Crime Prevention through environmental design）通过环境设计预防犯罪

                *   设计设施设计、景观美化、入口概念、校园布局、照明、道路布置以及车辆和步行车辆的交通管理

                *   核心原则

                    *   可以有目的地对物理环境的设计进行管理、操纵和精心编排，以便影响或改变这些区域中人们的行为，从而减少犯罪，并减少人们对犯罪的恐惧

                *   三种主要策略

                    *   自然环境访问控制---指通过设置入口，使用围栏和护柱，以及设置灯管，以对进程建筑物的人员进行微妙的引导

                    *   自然环境监视---是一种通过增加犯罪被观察到的机会来使其感到不安的手段

                    *   自然环境领域加固---使该区域令人感觉像一个包容、关爱的社区

    *   3.9、站点与设施安全控制设计

        *   配线间/中间布线设施

        *   服务器间/数据中心

        *   介质存储设施

        *   证据存储

        *   受限区与工作安全

            *   内部控制

            *   外部控制

        *   基础设施与HVAC

        *   环境问题---噪声

            *   电磁干扰 emi

                *   普通模式

                *   穿透模式

            *   无线电披绿干扰

        *   火灾预防、探测与消防

            *   火灾的四个阶段：早期、烟雾、火眼、炙热

            *   灭火器类型

                *   A普通燃烧物 --水

                *   B 液态 二氧化碳 、哈龙

                *   C 电气火灾 二氧化碳、哈龙

                *   D 金属 干粉

                *   K 烹饪油脂、碱性混合物、醋酸甲、碳酸钾、可发生皂化反应

            *   火灾探测：温度、火焰、烟雾

            *   消防系统：湿管系统、感官系统、预响应系统、密集洒水系统

            *   消防气体：哈龙、二氧化碳

        *   电源（如冗余、备份）

            *   UPS

            *   电力术语

                *   故障 fault

                *   停电 blackout

                *   电压骤降 sag

                *   低电压 brownout

                *   尖峰 spike

                *   浪涌 surge

                *   合闸电流 inrush

                *   接地 ground

        *   各种类型的控制顺序---威慑---拒绝---检测---延迟---判定---决定

        *   设备故障概念

            *   MTTF（Mean Time To Failure）：指平均故障时间，即设备在正常运行情况下发生故障的平均时间间隔。

            *   MTTR（Mean Time To Repair）：指平均修复时间，即设备在发生故障后，从故障发生到修复完成的平均时间间隔。

            *   SLA（Service Level Agreement）：指服务级别协议，是服务提供商与客户之间达成的协议，其中规定了服务的质量、可用性、响应时间等方面的要求和承诺。

    *   3.10 保护机制

        *   ROOTTKIT是一种恶意软件，它可以在操作系统中获得 root 权限，从而获得对系统的完全控制权。

        *   增量攻击是一种针对加密算法的攻击方式，它通过对加密算法进行逐步的修改，从而逐渐增加解密难度，最终达到解密的目的。

        *   隐蔽信道是一种通过合法的通信渠道传递秘密信息的方法。